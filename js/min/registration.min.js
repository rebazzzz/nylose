document.addEventListener("DOMContentLoaded",function(){let a=document.getElementById("personnummer"),s=document.querySelectorAll(".parent-field");var e=document.getElementById("register-btn");let t=document.getElementById("registration-modal");if(a){let e="YYYYMMDD-XXXX",r=(a.value=e,0);a.addEventListener("keydown",function(t){"0"<=t.key&&t.key<="9"?(t.preventDefault(),r<e.length&&"-"!==e[r]&&(n=a.value.substring(0,r)+t.key+a.value.substring(r+1),a.value=n,++r<e.length&&"-"===e[r]&&r++,a.setSelectionRange(r,r))):"Backspace"===t.key?(t.preventDefault(),0<r&&(r<e.length&&"-"===e[r-1]&&r--,r--,n=e[r],n=a.value.substring(0,r)+n+a.value.substring(r+1),a.value=n,a.setSelectionRange(r,r))):t.preventDefault();var n=a.value.replace(/[^0-9]/g,"");if(8<=n.length){var t=n.substring(0,8),n=parseInt(t.substring(0,4)),l=parseInt(t.substring(4,6))-1,t=parseInt(t.substring(6,8)),n=new Date(n,l,t),l=new Date;let e=l.getFullYear()-n.getFullYear();t=l.getMonth()-n.getMonth();(t<0||0==t&&l.getDate()<n.getDate())&&e--,e<18?s.forEach(e=>{e.style.display="flex";e=e.querySelector("input");e&&(e.required=!0)}):s.forEach(e=>{e.style.display="none";e=e.querySelector("input");e&&(e.required=!1)})}else s.forEach(e=>{e.style.display="none";e=e.querySelector("input");e&&(e.required=!1)})})}e&&e.addEventListener("click",function(){t&&(t.style.display="flex")}),window.closeRegistrationModal=function(){t&&(t.style.display="none")},t&&t.addEventListener("click",function(e){e.target===t&&closeRegistrationModal()})});
let API_BASE_URL="http://localhost:3001/api",scheduleData=[],sportsData=[];async function fetchFromAPI(t){try{var e=await fetch(""+API_BASE_URL+t);if(e.ok)return await e.json();throw new Error("HTTP "+e.status)}catch(e){return console.warn(`API call failed for ${t}:`,e.message),null}}async function loadScheduleData(){var e=await fetchFromAPI("/public/schedule");scheduleData=e||getMockScheduleData()}async function loadSportsData(){var e=await fetchFromAPI("/public/sports");sportsData=e||getMockSportsData()}function getMockScheduleData(){return[{day_of_week:"Måndag",start_time:"18:00",end_time:"19:00",sport_name:"Brottning",age_group:"6-13 år"},{day_of_week:"Måndag",start_time:"19:00",end_time:"21:00",sport_name:"Brottning",age_group:"14+"},{day_of_week:"Tisdag",start_time:"17:30",end_time:"18:30",sport_name:"Girls Only",age_group:"7-13 år"},{day_of_week:"Tisdag",start_time:"18:30",end_time:"19:45",sport_name:"Girls Only",age_group:"13+"},{day_of_week:"Onsdag",start_time:"18:00",end_time:"19:00",sport_name:"Brottning",age_group:"6-13 år"},{day_of_week:"Onsdag",start_time:"19:00",end_time:"21:00",sport_name:"Brottning",age_group:"14+"},{day_of_week:"Torsdag",start_time:"17:30",end_time:"18:30",sport_name:"Girls Only",age_group:"7-13 år"},{day_of_week:"Torsdag",start_time:"18:30",end_time:"19:45",sport_name:"Girls Only",age_group:"13+"},{day_of_week:"Fredag",start_time:"18:00",end_time:"20:00",sport_name:"Wresfit",age_group:"Alla åldrar"},{day_of_week:"Söndag",start_time:"12:00",end_time:"13:00",sport_name:"Brottning",age_group:"6-13 år"},{day_of_week:"Söndag",start_time:"13:00",end_time:"14:00",sport_name:"Brottning",age_group:"14+"}]}function getMockSportsData(){return[{name:"Brottning",description:"Greco-Roman och Freestyle brottning"},{name:"Wresfit",description:"Funktionell styrketräning"},{name:"Girls Only",description:"Boxning för tjejer"}]}function populateWeeklyScheduleCards(e=null){var t=document.getElementById("weekly-schedule-cards"),r=(t.innerHTML="",scheduleData.map(e=>({day:e.day_of_week,time:e.start_time+"-"+e.end_time,activity:e.sport_name,level:e.age_group})));let n=r,a=(e&&"all"!==e&&("brottning-barn"===e?n=r.filter(e=>"Brottning"===e.activity&&"6-13 år"===e.level):"brottning-vuxna"===e?n=r.filter(e=>"Brottning"===e.activity&&"14+"===e.level):"girls-only"===e?n=r.filter(e=>"Girls Only"===e.activity):"girls-only-7-13"===e?n=r.filter(e=>"Girls Only"===e.activity&&"7-13 år"===e.level):"girls-only-13"===e?n=r.filter(e=>"Girls Only"===e.activity&&"13+"===e.level):"wresfit"===e&&(n=r.filter(e=>"Wresfit"===e.activity))),{});n.forEach(e=>{a[e.day]||(a[e.day]=[]),a[e.day].push(e)});var i,e=(new Date).toLocaleDateString("sv-SE",{weekday:"long"}),l=e.charAt(0).toUpperCase()+e.slice(1);for(i in a){let o=document.createElement("div");o.className="day-container "+(i===l?"today":"");var s=document.createElement("h3");s.className="day-header",s.textContent=i,o.appendChild(s),a[i].forEach(e=>{var t=document.createElement("div"),r=(t.className=`session-card ${getActivityClass(e.activity)} `+getLevelClass(e.level),t.setAttribute("data-filter",getFilterKey(e.activity,e.level)),document.createElement("div")),n=(r.className="session-icon",r.innerHTML=getActivityIcon(e.activity,e.level),document.createElement("div")),a=(n.className="session-content",document.createElement("div")),i=(a.className="session-time",a.textContent=e.time,document.createElement("div")),l=(i.className="session-activity",i.textContent=e.activity,document.createElement("div"));l.className="session-level",l.textContent=e.level,n.appendChild(a),n.appendChild(i),n.appendChild(l),t.appendChild(r),t.appendChild(n),o.appendChild(t)}),t.appendChild(o)}0===Object.keys(a).length&&((r=document.createElement("div")).className="no-sessions",r.textContent="Inga träningar hittades för denna filtrering.",t.appendChild(r))}function getFilterKey(e,t){return"Brottning"===e?"6-13 år"===t?"brottning-barn":"brottning-vuxna":"Girls Only"===e?"7-13 år"===t?"girls-only-7-13":"13+"===t?"girls-only-13":"girls-only":"Wresfit"===e?"wresfit":""}function filterSessions(r){document.querySelectorAll(".session-card").forEach(e=>{var t=e.getAttribute("data-filter");e.style.display="all"===r||t===r?"flex":"none"})}function getActivityClass(e){switch(e){case"Brottning":return"brottning";case"Wresfit":return"wresfit";case"Girls Only":return"girls-only";default:return""}}function getLevelClass(e){return"6-13 år"===e||"7-13 år"===e?"barn":"14+"===e||"13+"===e?"vuxna":""}function getActivityIcon(e,t){switch(e){case"Brottning":return`<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" fill="currentColor"/>
                        </svg>`;case"Wresfit":return`<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6 8h2v8H6V8zM16 8h2v8h-2V8zM8 6h8v2H8V6zM8 16h8v2H8v-2z" fill="currentColor"/>
                        <circle cx="5" cy="10" r="1" fill="currentColor"/>
                        <circle cx="19" cy="10" r="1" fill="currentColor"/>
                        <circle cx="5" cy="14" r="1" fill="currentColor"/>
                        <circle cx="19" cy="14" r="1" fill="currentColor"/>
                    </svg>`;case"Girls Only":return`<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="12" cy="8" r="4" stroke="currentColor" stroke-width="2"/>
                        <path d="M6 20c0-3.5 2.7-6.5 6-6.5s6 3 6 6.5" stroke="currentColor" stroke-width="2"/>
                    </svg>`;default:return""}}function toggleMenu(){var e=document.querySelector(".nav-links"),t=document.querySelector(".hamburger"),r=document.querySelector(".menu-overlay"),e=e.classList.toggle("active");t.classList.toggle("active"),r.classList.toggle("active"),t.setAttribute("aria-expanded",e)}function bookSession(e,t,r){alert(`Bokning för ${r} ${e} ${t} har lagts till. (Funktionalitet kommer att implementeras med backend)`)}function handleLoginClick(){document.getElementById("login-modal").style.display="flex"}function closeLoginModal(){document.getElementById("login-modal").style.display="none"}document.addEventListener("keydown",function(e){var t,r;"Escape"===e.key&&(e=document.querySelector(".nav-links"),t=document.querySelector(".hamburger"),r=document.querySelector(".menu-overlay"),e&&e.classList.remove("active"),t&&(t.classList.remove("active"),t.setAttribute("aria-expanded","false")),r)&&r.classList.remove("active")}),document.addEventListener("DOMContentLoaded",async function(){await loadScheduleData(),await loadSportsData();var e=document.getElementById("contact-form");e&&e.addEventListener("submit",function(e){e.preventDefault(),alert("Tack för ditt meddelande! Vi återkommer så snart som möjligt."),this.reset()});e=new URLSearchParams(window.location.search).get("sport");document.getElementById("weekly-schedule-cards")&&populateWeeklyScheduleCards(e),document.querySelectorAll(".nav-links a").forEach(e=>{e.addEventListener("click",()=>{document.querySelector(".nav-links").classList.remove("active"),document.querySelector(".hamburger").classList.remove("active"),document.querySelector(".menu-overlay").classList.remove("active"),document.querySelector(".hamburger").setAttribute("aria-expanded","false")})}),document.querySelectorAll(".filter-btn").forEach(e=>{e.addEventListener("click",function(){console.log("Filter button clicked:",this.getAttribute("data-filter")),document.querySelectorAll(".filter-btn").forEach(e=>e.classList.remove("active")),this.classList.add("active"),populateWeeklyScheduleCards(this.getAttribute("data-filter"))})})});
function handleLoginClick(){var e=localStorage.getItem("token"),t=JSON.parse(localStorage.getItem("user")||"null");e&&t?"admin"===t.role?window.location.href="admin.html":confirm("Är du säker på att du vill logga ut?")&&(localStorage.removeItem("token"),localStorage.removeItem("user"),location.reload()):showLoginModal()}function showLoginModal(){var e=document.getElementById("login-modal");e&&(e.style.display="block",document.body.style.overflow="hidden")}function closeLoginModal(){var e=document.getElementById("login-modal");e&&(e.style.display="none",document.body.style.overflow="auto")}async function handleLoginSubmit(e){e.preventDefault();var e=document.getElementById("login-email").value,t=document.getElementById("login-password").value;try{var o=await fetch("http://localhost:3001/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),n=await o.json();o.ok?(localStorage.setItem("token",n.token),localStorage.setItem("user",JSON.stringify(n.user)),closeLoginModal(),updateProfileButton(),"admin"===n.user.role?window.location.href="admin.html":location.reload()):alert("Inloggning misslyckades: "+n.error)}catch(e){console.error("Login error:",e),alert("Ett fel uppstod vid inloggning. Försök igen senare.")}}function updateProfileButton(){var e=document.getElementById("profile-button"),t=localStorage.getItem("token"),o=JSON.parse(localStorage.getItem("user")||"null");e&&(t&&o?(e.innerHTML=`
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 12C14.7614 12 17 9.76142 17 7C17 4.23858 14.7614 2 12 2C9.23858 2 7 4.23858 7 7C7 9.76142 9.23858 12 12 12Z" stroke="#000000" stroke-width="2"/>
          <path d="M20 22C20 18.6863 16.4183 16 12 16C7.58172 16 4 18.6863 4 22" stroke="#000000" stroke-width="2"/>
        </svg>
      `,e.title="Logga ut"):(e.innerHTML=`
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 12C14.7614 12 17 9.76142 17 7C17 4.23858 14.7614 2 12 2C9.23858 2 7 4.23858 7 7C7 9.76142 9.23858 12 12 12Z" stroke="#000000" stroke-width="2"/>
          <path d="M20 22C20 18.6863 16.4183 16 12 16C7.58172 16 4 18.6863 4 22" stroke="#000000" stroke-width="2"/>
        </svg>
      `,e.title="Logga in"))}async function loadComponent(e,t){try{var o=await fetch(t);if(!o.ok)throw new Error("Failed to load "+t);var n=await o.text(),l=document.getElementById(e);l&&(l.innerHTML=n)}catch(e){console.error("Error loading component:",e)}}function setActiveNavLink(){let o=window.location.pathname.split("/").pop()||"index.html";var e;document.querySelectorAll(".nav-links a").forEach(e=>{e.classList.remove("current");var t=e.getAttribute("href").split("#")[0]||"index.html";(t===o||""===o&&"index.html"===t)&&e.classList.add("current")}),"index.html"===o&&(e=document.querySelector(".nav-home"))&&(e.parentElement.style.display="none")}document.addEventListener("DOMContentLoaded",async function(){await loadComponent("navbar-placeholder","navbar.html"),await loadComponent("footer-placeholder","footer.html"),setTimeout(setActiveNavLink,100),setTimeout(()=>{var e=document.getElementById("profile-button");e&&(e.addEventListener("click",handleLoginClick),updateProfileButton())},100),setTimeout(()=>{document.querySelectorAll(".nav-links a").forEach(e=>{e.addEventListener("click",()=>{document.querySelector(".nav-links").classList.remove("active"),document.querySelector(".hamburger").classList.remove("active"),document.querySelector(".menu-overlay").classList.remove("active"),document.querySelector(".hamburger").setAttribute("aria-expanded","false")})});let t=document.getElementById("login-modal");t&&t.addEventListener("click",function(e){e.target===t&&closeLoginModal()});var e=document.getElementById("login-form");e&&e.addEventListener("submit",handleLoginSubmit)},100)});
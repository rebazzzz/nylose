document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("admin-login-form");let o=document.getElementById("error-message"),i=e.querySelector('button[type="submit"]');e.addEventListener("submit",async function(e){e.preventDefault();var e=document.getElementById("email").value.trim(),t=document.getElementById("password").value;if(o.textContent="",e&&t){i.disabled=!0,i.innerHTML='<i class="fas fa-spinner fa-spin"></i> Loggar in...';try{var n=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),a=await n.json();n.ok?(localStorage.setItem("token",a.token),localStorage.setItem("user",JSON.stringify(a.user)),"admin"===a.user.role?window.location.href="admin-dashboard.html":o.textContent="Du har inte administratörsbehörighet."):o.textContent=a.error||"Inloggning misslyckades."}catch(e){console.error("Login error:",e),o.textContent="Ett fel uppstod. Försök igen senare."}finally{i.disabled=!1,i.innerHTML='<i class="fas fa-sign-in-alt"></i> Logga in'}}else o.textContent="Vänligen fyll i alla fält."});var e=localStorage.getItem("token"),t=JSON.parse(localStorage.getItem("user")||"null");e&&t&&"admin"===t.role&&(window.location.href="admin-dashboard.html")});